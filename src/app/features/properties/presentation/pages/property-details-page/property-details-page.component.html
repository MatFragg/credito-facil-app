<div class="details-container">
    <!-- Loading State -->
    @if (loading()) {
    <div class="loading-state">
        <p>Cargando propiedad...</p>
    </div>
    }

    <!-- Error State -->
    @if (error() && !loading()) {
    <div class="error-state">
        <mat-icon>error_outline</mat-icon>
        <p>{{ error() }}</p>
        <button mat-raised-button color="primary" (click)="goBack()">
            <mat-icon>arrow_back</mat-icon>
            Volver al Catálogo
        </button>
    </div>
    }

    <!-- Property Details -->
    @if (property() && !loading()) {
    <div class="details-content">
        <!-- Header -->
        <div class="details-header">
            <button mat-icon-button (click)="goBack()" class="back-button">
                <mat-icon>arrow_back</mat-icon>
            </button>
            <div class="header-info">
                <h1>{{ property()!.propertyName || property()!.projectName }}</h1>
                <mat-chip [color]="getStatusColor()" highlighted>
                    {{ getStatusLabel() }}
                </mat-chip>
            </div>
        </div>

        <!-- Image Section -->
        <div class="image-section">
            @if (property()!.imageUrl) {
            <img [src]="property()!.imageUrl" [alt]="property()!.propertyName || 'Propiedad'" class="property-image">
            } @else {
            <div class="image-placeholder">
                <mat-icon>home</mat-icon>
                <p>Sin imagen disponible</p>
            </div>
            }
        </div>

        <!-- Details Grid -->
        <div class="details-grid">
            <!-- Left Column: Main Details -->
            <mat-card class="details-card">
                <mat-card-header>
                    <mat-card-title>Información Principal</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <div class="detail-row price-row">
                        <span class="detail-label">Precio</span>
                        <span class="detail-value price">{{ formatPrice() }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Tipo de Propiedad</span>
                        <span class="detail-value">{{ getPropertyTypeLabel() }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Código</span>
                        <span class="detail-value">{{ property()!.propertyCode }}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Área</span>
                        <span class="detail-value">{{ property()!.area }} m²</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Dormitorios</span>
                        <span class="detail-value">
                            <mat-icon class="inline-icon">bed</mat-icon>
                            {{ property()!.bedrooms }}
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Baños</span>
                        <span class="detail-value">
                            <mat-icon class="inline-icon">bathroom</mat-icon>
                            {{ property()!.bathrooms }}
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Estacionamientos</span>
                        <span class="detail-value">
                            <mat-icon class="inline-icon">local_parking</mat-icon>
                            {{ property()!.parkingSpaces }}
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Antigüedad</span>
                        <span class="detail-value">{{ property()!.ageYears }} años</span>
                    </div>
                </mat-card-content>
            </mat-card>

            <!-- Right Column: Location & Description -->
            <mat-card class="details-card">
                <mat-card-header>
                    <mat-card-title>Ubicación</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <div class="location-info">
                        <mat-icon class="location-icon">location_on</mat-icon>
                        <div class="location-text">
                            <p class="address">{{ property()!.address }}</p>
                            <p class="location-details">
                                {{ property()!.district }}, {{ property()!.province }}, {{ property()!.city }}
                            </p>
                        </div>
                    </div>

                    @if (property()!.projectName) {
                    <div class="project-info">
                        <span class="detail-label">Proyecto</span>
                        <span class="detail-value">{{ property()!.projectName }}</span>
                    </div>
                    }

                    @if (property()!.description) {
                    <div class="description-section">
                        <h3>Descripción</h3>
                        <p class="description-text">{{ property()!.description }}</p>
                    </div>
                    }
                </mat-card-content>
            </mat-card>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button mat-stroked-button (click)="goBack()">
                <mat-icon>arrow_back</mat-icon>
                Volver
            </button>
            <button mat-raised-button color="primary" (click)="createSimulation()">
                <mat-icon>calculate</mat-icon>
                Crear Simulación
            </button>
            <button mat-raised-button color="warn" (click)="deleteProperty()">
                <mat-icon>delete</mat-icon>
                Eliminar
            </button>
        </div>
    </div>
    }
</div>